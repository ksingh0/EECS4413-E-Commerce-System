<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Item Details</title>
<link rel="stylesheet" href="styles.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>

	<header>
		<h1>Auction Item Details</h1>

	</header>
	
		<div class="container">
		<table id ="catalogueTable" border="1">
		<thead>
		 	<tr>
 				<th>Item Name</th>
 				<th>Description</th>
 				<th>Shipping Cost</th>
 				<th>Current Bid</th>
 				<th>Auction Type</th>
 				<th>Remaining Time</th>
 			</tr>
 		</thead>
 <!-- Rows will be dynamically added here -->
 		</table>
		</div>
 <!-- Bidding label and button  -->
 <div id="bidSection">
 		<label for="bidAmount">Enter your Bid:</label>
 		<input type="number" id="bidAmount" step="0.01" min="0">
 		<button id="bidButton">BID</button>
 </div>
 		
		
	<footer>
		<p>Â© 2025 eCommerce Auction Platform</p>
	</footer>

	<script>
 //Get item usign id from URL
 function getItemId() {
	 const params = new URLSearchParams(window.location.search);
	 return params.get("item_id");
 }
 
//Load the details for item: Name, description, shipping cost, current bit , and hihest biddder
function loadItemDetails(){
	const item_id = getItemId();
	
	$.ajax({
		 url: "http://localhost:8080/ecommerce-auction-system/api/items/" + item_id,
		 type: 'GET',
		 success: function(item){
		 //retrieve item user clicked on: 
	     //name, Description, Shipping Cost, current Bidding price, Auction Type, Remaining Time
			 var table = $("#catalogueTable");
			 var tbody = table.find("tbody");
			 
			 if(tbody.length === 0){
				 tbody = $("<tbody></tbody>")
				 table.append(tbody);
			 }
			 tbody.empty();
		 
		 let row = $("<tr></tr>");
 			row.append($("<td></td>").text(item.item_name));
 			row.append($("<td></td>").text(item.item_description));
 			row.append($("<td></td>").text("$" + item.shipping_cost));
 			row.append($("<td></td>").text(item.current_bid));
 			row.append($("<td></td>").text(item.auction_type));
 			row.append($("<td></td>").text(item.remaining_time));
 			tbody.append(row);
				
		},
		 error: function(error){
		 console.log("Cannot load Item", error);
		 	}
		 });
	
	}
	
	
//Laod only the Bidding Item
$(document).ready(function() {
	loadItemDetails();
});
	
	//BID button (take bidAmount price)
	$("#bidButton").click(function() {
		const bidAmount  = $("#bidAmount").val();
		const item_id = getItemId();
		
		//server side validations, value must be greater than 0 and highest curent bidder 
		if(bidAmount <=0 || !bidAmount){
			alert("Must be greater than 0")
			return;
		}
		
		alert("BID is now posted")
		// handle bids 
		
	});
	

</script>

</body>
</html>
